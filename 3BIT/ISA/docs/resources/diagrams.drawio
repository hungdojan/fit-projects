<mxfile host="65bd71144e">
    <diagram id="RbQfovTWDlcBjstpYOmP" name="Class diagram">
        <mxGraphModel dx="936" dy="658" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
            <root>
                <mxCell id="U9qJtLw5xcD7s-tx1f1j-0"/>
                <mxCell id="U9qJtLw5xcD7s-tx1f1j-1" parent="U9qJtLw5xcD7s-tx1f1j-0"/>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-0" value="Receiver" style="shape=module;align=left;spacingLeft=20;align=center;verticalAlign=top;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="30" y="30" width="550" height="420" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-1" value="Sender" style="shape=module;align=left;spacingLeft=20;align=center;verticalAlign=top;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="590" y="30" width="540" height="420" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-47" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-12" target="F_u8oEnG5R-xwCjrv69D-44" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-48" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-12" target="F_u8oEnG5R-xwCjrv69D-40" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-49" style="edgeStyle=none;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-12" target="F_u8oEnG5R-xwCjrv69D-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-12" value="&lt;p style=&quot;margin: 0px ; margin-top: 6px ; text-align: center&quot;&gt;&lt;b&gt;dns_query&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- check_received_packet(void *, size_t): int&lt;br&gt;- append_chunk_id(void *, data_queue_t *): size_t&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- fill_header(uint8_t *, size_t): uint8_t *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- convert_qname_to_format(uint8_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ assemble_query(uint8_t *, size_t,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;uint8_t *, size_t): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ create_query_domain_name(uint8_t *, size_t,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;args_t *, data_queue_t *): int&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ create_init_query_domain(uint8_t *, size_t,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;args_t *, data_queue_t *): int&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ send_data_ipv4(int, sockaddr_in *, FILE *,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;args_t *): int&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ send_data_ipv6(int, sockaddr_in6, FILE *,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;args_t *): int&lt;/span&gt;&lt;/p&gt;" style="align=left;overflow=fill;html=1;dropTarget=0;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="830" y="50" width="290" height="260" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-13" value="" style="shape=component;jettyWidth=8;jettyHeight=4;fontSize=12;" parent="F_u8oEnG5R-xwCjrv69D-12" vertex="1">
                    <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
                        <mxPoint x="-24" y="4" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-17" value="Include" style="shape=module;align=left;spacingLeft=20;align=center;verticalAlign=top;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="285" y="470" width="600" height="340" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-53" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-24" target="F_u8oEnG5R-xwCjrv69D-25" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-24" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;i&gt;&amp;lt;&amp;lt;Interface&amp;gt;&amp;gt;&lt;/i&gt;&lt;br&gt;&lt;b&gt;data_queue_t&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ init_queue(FILE *f, args_t *): data_queue_t *&lt;br&gt;+ update_data(data_queue_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ get_encoded_data_from_file(data_queue_t *,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&amp;nbsp; uint8_t *, size_t): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ flush_data_to_file(data_queue_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ append_data_from_domain(data_queue_t *,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;uint8_t *, size_t): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ destroy_queue(data_queue_t *): void&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="325" y="500" width="290" height="170" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-25" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;base64.h&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="325" y="710" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-26" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;macros.h&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="465" y="740" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-27" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;error.h&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="465" y="680" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-51" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-29" target="F_u8oEnG5R-xwCjrv69D-31" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-52" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-29" target="F_u8oEnG5R-xwCjrv69D-30" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-29" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;dns_header&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ id: uint16_t&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ param: union { dns_param_query;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&amp;nbsp; &amp;nbsp;dns_param_response}&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ q_count: uint16_t&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ ar_count: uint16_t&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ ns_count: uint16_t&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ addit_count: uint16_t&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="640" y="500" width="220" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-30" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;dns_param_response&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="640" y="740" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-31" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;dns_param_query&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="740" y="680" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-32" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;args_t&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ base_host: const char *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ upstream_dns_ip: char *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ dst_filepath: const char *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ src_filepath: const char *&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ load_args(args_t *, int, char **): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;- usage(): void&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="620" y="50" width="200" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-45" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-34" target="F_u8oEnG5R-xwCjrv69D-32" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-46" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" parent="U9qJtLw5xcD7s-tx1f1j-1" target="F_u8oEnG5R-xwCjrv69D-12" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="730" y="249.18601308129087" as="sourcePoint"/>
                        <mxPoint x="829" y="260" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-34" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;main.c&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="650" y="220" width="80" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-39" value="data_queue_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="620" y="280" width="160" height="160" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-40" value="+ data: uint8_t*&#10;+ index_to_read: size_t&#10;+ encoded_len: size_t&#10;+ f: FILE *&#10;+ file_size: size_t&#10;+ encoded_chunk: size_t&#10;+ raw_encoded_len: size_t&#10;+ args: args_t *&#10;+ chunkID: size_t" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" parent="F_u8oEnG5R-xwCjrv69D-39" vertex="1">
                    <mxGeometry y="26" width="160" height="134" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-43" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-40" target="F_u8oEnG5R-xwCjrv69D-24" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="610" y="500" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-44" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;dns_sender_events.c&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="890" y="380" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-50" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-12" target="F_u8oEnG5R-xwCjrv69D-29" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-62" style="edgeStyle=none;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-54" target="F_u8oEnG5R-xwCjrv69D-56" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-66" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-54" target="F_u8oEnG5R-xwCjrv69D-63" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-54" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;main.c&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="80" y="200" width="80" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-55" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;br&gt;&lt;b&gt;dns_receiver_events.c&lt;/b&gt;&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="410" y="60" width="150" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-56" value="&lt;p style=&quot;margin: 0px ; margin-top: 4px ; text-align: center&quot;&gt;&lt;b&gt;args_t&lt;/b&gt;&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ base_host: const char *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ dst_dirpath: const char *&lt;/p&gt;&lt;hr size=&quot;1&quot;&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;+ load_args(args_t *, int, char **): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 4px&quot;&gt;- usage(): void&lt;/p&gt;" style="verticalAlign=top;align=left;overflow=fill;fontSize=12;fontFamily=Helvetica;html=1;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="60" y="60" width="200" height="110" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-59" value="data_queue_t" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="60" y="280" width="160" height="150" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-60" value="+ data: uint8_t*&#10;+ index_to_read: size_t&#10;+ encoded_len: size_t&#10;+ f: FILE *&#10;+ file_size: size_t&#10;+ encoded_chunk: size_t&#10;+ file_name: char *&#10;+ chunkID: size_t" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=12;" parent="F_u8oEnG5R-xwCjrv69D-59" vertex="1">
                    <mxGeometry y="26" width="160" height="124" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-61" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;entryX=0.25;entryY=0;entryDx=0;entryDy=0;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-60" target="F_u8oEnG5R-xwCjrv69D-24" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-65" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-63" target="F_u8oEnG5R-xwCjrv69D-55" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-67" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;exitX=0;exitY=0.25;exitDx=0;exitDy=0;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-63" target="F_u8oEnG5R-xwCjrv69D-56" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-68" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-63" target="F_u8oEnG5R-xwCjrv69D-29" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-69" style="edgeStyle=none;html=1;fontSize=12;strokeWidth=3;" parent="U9qJtLw5xcD7s-tx1f1j-1" source="F_u8oEnG5R-xwCjrv69D-63" target="F_u8oEnG5R-xwCjrv69D-60" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-63" value="&lt;p style=&quot;margin: 0px ; margin-top: 6px ; text-align: center&quot;&gt;&lt;b&gt;dns_response&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- extract_chunk_ID(uint8_t *, size_t *): size_t&lt;br&gt;- is_ipv4_mapped(void *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- get_ip_address(sockaddr *): void *&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- receive_packet_check(int, void *, size_t,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;sockaddr *, socklen_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- convert_qname_to_format(char *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;- convert_format_to_qname(char *): void&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ validate_tunnel_communication(void *,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;size_t, char *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ get_file_name(uint8_t *, uint8_t *, args_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ create_response(uint8_t *):&lt;span&gt;&amp;nbsp;int&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ normal_dns_response(int, uint8_t *, size_t, size_t,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;/span&gt;sockaddr_in *, socklen_t *): int&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;+ process_init_packet(int, args_t *, data_queue_t **,&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;uint8_t&amp;nbsp;*, size_t, sockaddr *,&amp;nbsp;&lt;/span&gt;&lt;span&gt;socklen_t *): int&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span&gt;+ process_tunneling_data(uint8_t *, char *,&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt;&#9;&lt;/span&gt;data_queue_t *): int&lt;br&gt;&lt;/span&gt;&lt;/p&gt;&lt;p style=&quot;margin: 0px ; margin-left: 8px&quot;&gt;&lt;span&gt;+ run_communication(int, args_t *): int&lt;/span&gt;&lt;/p&gt;" style="align=left;overflow=fill;html=1;dropTarget=0;fontSize=12;" parent="U9qJtLw5xcD7s-tx1f1j-1" vertex="1">
                    <mxGeometry x="270" y="130" width="290" height="300" as="geometry"/>
                </mxCell>
                <mxCell id="F_u8oEnG5R-xwCjrv69D-64" value="" style="shape=component;jettyWidth=8;jettyHeight=4;fontSize=12;" parent="F_u8oEnG5R-xwCjrv69D-63" vertex="1">
                    <mxGeometry x="1" width="20" height="20" relative="1" as="geometry">
                        <mxPoint x="-24" y="4" as="offset"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="Q5PKtIPmYla0WtoodmxI" name="fsm receiver">
        <mxGraphModel dx="936" dy="658" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
            <root>
                <mxCell id="fCrUIj7ICpANIgIqwlMM-0"/>
                <mxCell id="fCrUIj7ICpANIgIqwlMM-1" parent="fCrUIj7ICpANIgIqwlMM-0"/>
                <mxCell id="I3N1WQbEvghAyw6arRP5-0" value="Start" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="20" y="210" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-1" value="Load&lt;br&gt;arguments" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="130" y="200" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-2" value="Init and &lt;br&gt;bind&lt;br&gt;socket" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="100" y="414" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-11" value="" style="html=1;verticalAlign=bottom;endArrow=block;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.002;entryY=0.582;entryDx=0;entryDy=0;entryPerimeter=0;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-0" target="I3N1WQbEvghAyw6arRP5-1" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="310" y="110" as="sourcePoint"/>
                        <mxPoint x="390" y="110" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-12" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-1" target="I3N1WQbEvghAyw6arRP5-2" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="280" y="260" as="sourcePoint"/>
                        <mxPoint x="360" y="260" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-13" value="NO_ERR" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="I3N1WQbEvghAyw6arRP5-12" vertex="1" connectable="0">
                    <mxGeometry x="-0.32" y="1" relative="1" as="geometry">
                        <mxPoint x="24" y="3" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-14" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-2" target="I3N1WQbEvghAyw6arRP5-34" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="250" y="350" as="sourcePoint"/>
                        <mxPoint x="250" y="520" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-15" value="NO_ERR" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="I3N1WQbEvghAyw6arRP5-14" vertex="1" connectable="0">
                    <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
                        <mxPoint x="24" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-16" value="Error" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="430" y="30" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-17" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-1" target="I3N1WQbEvghAyw6arRP5-16" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="320" y="230" as="sourcePoint"/>
                        <mxPoint x="400" y="230" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-18" value="ERR_ARGS" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="I3N1WQbEvghAyw6arRP5-17" vertex="1" connectable="0">
                    <mxGeometry x="-0.0891" y="2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-19" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-2" target="I3N1WQbEvghAyw6arRP5-16" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="280" y="205" as="sourcePoint"/>
                        <mxPoint x="460.25126265847086" y="250.25126265847086" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-20" value="ERR_SOCKET/&lt;br&gt;ERR_BIND" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="I3N1WQbEvghAyw6arRP5-19" vertex="1" connectable="0">
                    <mxGeometry x="-0.0891" y="2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-21" value="End" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="630" y="80" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-22" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-16" target="I3N1WQbEvghAyw6arRP5-21" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="510" y="350" as="sourcePoint"/>
                        <mxPoint x="590" y="390" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-1" style="edgeStyle=none;html=1;fontSize=35;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-34" target="X-xb75h-JxixIpVZp8A_-0">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-8" value="qtype != TXT || &lt;br&gt;base_host not same" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="X-xb75h-JxixIpVZp8A_-1">
                    <mxGeometry x="0.2103" relative="1" as="geometry">
                        <mxPoint y="-12" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-9" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="I3N1WQbEvghAyw6arRP5-34" target="X-xb75h-JxixIpVZp8A_-5">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-34" value="Wait for&lt;br&gt;init packet" style="ellipse;whiteSpace=wrap;html=1;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="320" y="420" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="I3N1WQbEvghAyw6arRP5-35" value="&lt;font style=&quot;font-size: 35px&quot;&gt;DNS receiver&lt;br&gt;Finite State Machine&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="fCrUIj7ICpANIgIqwlMM-1" vertex="1">
                    <mxGeometry x="15" y="60" width="330" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-3" style="edgeStyle=none;html=1;fontSize=35;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-0" target="X-xb75h-JxixIpVZp8A_-2">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-0" value="Normal&lt;br&gt;DNS query" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="420" y="550" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-4" style="edgeStyle=none;html=1;fontSize=35;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-2" target="I3N1WQbEvghAyw6arRP5-34">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-2" value="Get response from 8.8.8.8" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="220" y="560" width="110" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-13" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-5" target="X-xb75h-JxixIpVZp8A_-10">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-5" value="Open dst file" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="360" y="270" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-15" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-10" target="X-xb75h-JxixIpVZp8A_-11">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-19" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-10" target="I3N1WQbEvghAyw6arRP5-16">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-20" value="Timeout/&lt;br&gt;connection lost" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="X-xb75h-JxixIpVZp8A_-19">
                    <mxGeometry x="-0.1606" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-10" value="Receive data" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="540" y="220" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-16" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-11" target="X-xb75h-JxixIpVZp8A_-12">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-11" value="Decode data" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="710" y="240" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-17" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-12" target="X-xb75h-JxixIpVZp8A_-14">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-12" value="Write to file" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="780" y="350" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-18" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-14" target="X-xb75h-JxixIpVZp8A_-10">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-23" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-14" target="X-xb75h-JxixIpVZp8A_-25">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-24" value="Last packet received" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="X-xb75h-JxixIpVZp8A_-23">
                    <mxGeometry x="-0.1493" y="-1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-14" value="Send confirmation" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="640" y="450" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-21" style="edgeStyle=none;html=1;exitX=0.714;exitY=0.018;exitDx=0;exitDy=0;entryX=0.984;entryY=0.353;entryDx=0;entryDy=0;fontSize=12;exitPerimeter=0;entryPerimeter=0;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-10" target="X-xb75h-JxixIpVZp8A_-10">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="650" y="190"/>
                            <mxPoint x="650" y="230"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-22" value="ERR_OLD_PACKET" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="X-xb75h-JxixIpVZp8A_-21">
                    <mxGeometry x="-0.0634" y="-1" relative="1" as="geometry">
                        <mxPoint x="35" y="8" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-26" style="edgeStyle=none;html=1;fontSize=12;" edge="1" parent="fCrUIj7ICpANIgIqwlMM-1" source="X-xb75h-JxixIpVZp8A_-25" target="I3N1WQbEvghAyw6arRP5-34">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="X-xb75h-JxixIpVZp8A_-25" value="Flush last chunk to file" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="fCrUIj7ICpANIgIqwlMM-1">
                    <mxGeometry x="440" y="350" width="70" height="70" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="gl2EEQEESjaHCPbTQkDM" name="fsm sender">
        <mxGraphModel grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" page="1" fold="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="i9FF9yoav58OheTaMKSd-1" value="Start" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="20" y="210" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-2" value="Load&lt;br&gt;arguments" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="130" y="200" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-3" value="Init&lt;br&gt;socket" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="100" y="414" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-4" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-7" target="i9FF9yoav58OheTaMKSd-9" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-5" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-7" target="i9FF9yoav58OheTaMKSd-22" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-6" value="Last packet&lt;br&gt;was sent" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-5" vertex="1" connectable="0">
                    <mxGeometry x="-0.5872" y="3" relative="1" as="geometry">
                        <mxPoint x="58" y="-41" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-7" value="Read&lt;br&gt;file" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="600" y="529" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-8" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-9" target="i9FF9yoav58OheTaMKSd-11" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-9" value="Encode&lt;br&gt;data" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="360" y="409" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-10" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-11" target="i9FF9yoav58OheTaMKSd-25" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-11" value="Create&lt;br&gt;query" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="450" y="299" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-12" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" source="i9FF9yoav58OheTaMKSd-1" target="i9FF9yoav58OheTaMKSd-2" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="310" y="110" as="sourcePoint"/>
                        <mxPoint x="390" y="110" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-13" value="" style="html=1;verticalAlign=bottom;endArrow=block;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="i9FF9yoav58OheTaMKSd-2" target="i9FF9yoav58OheTaMKSd-3" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="280" y="260" as="sourcePoint"/>
                        <mxPoint x="360" y="260" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-14" value="NO_ERR" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-13" vertex="1" connectable="0">
                    <mxGeometry x="-0.32" y="1" relative="1" as="geometry">
                        <mxPoint x="24" y="3" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-15" value="" style="html=1;verticalAlign=bottom;endArrow=block;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="i9FF9yoav58OheTaMKSd-3" target="i9FF9yoav58OheTaMKSd-35" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="250" y="350" as="sourcePoint"/>
                        <mxPoint x="250" y="520" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-16" value="NO_ERR" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-15" vertex="1" connectable="0">
                    <mxGeometry x="-0.3" y="1" relative="1" as="geometry">
                        <mxPoint x="24" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-17" value="Error" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="430" y="30" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-18" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" source="i9FF9yoav58OheTaMKSd-2" target="i9FF9yoav58OheTaMKSd-17" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="320" y="230" as="sourcePoint"/>
                        <mxPoint x="400" y="230" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-19" value="ERR_ARGS" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-18" vertex="1" connectable="0">
                    <mxGeometry x="-0.0891" y="2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-20" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" source="i9FF9yoav58OheTaMKSd-3" target="i9FF9yoav58OheTaMKSd-17" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="280" y="205" as="sourcePoint"/>
                        <mxPoint x="460.25126265847086" y="250.25126265847086" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-21" value="ERR_SOCKET" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-20" vertex="1" connectable="0">
                    <mxGeometry x="-0.0891" y="2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-22" value="End" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="800" y="339" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-23" value="" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" source="i9FF9yoav58OheTaMKSd-17" target="i9FF9yoav58OheTaMKSd-22" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="510" y="350" as="sourcePoint"/>
                        <mxPoint x="590" y="390" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-24" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-25" target="i9FF9yoav58OheTaMKSd-31" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="650" y="435"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-25" value="Send&lt;br&gt;packet" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="515" y="400" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-26" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-31" target="i9FF9yoav58OheTaMKSd-7" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-27" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-31" target="i9FF9yoav58OheTaMKSd-25" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <Array as="points">
                            <mxPoint x="620" y="384"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-28" value="Timeout/&lt;br&gt;host unreachable" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-27" vertex="1" connectable="0">
                    <mxGeometry x="-0.3356" relative="1" as="geometry">
                        <mxPoint x="-30" y="-15" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-29" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-31" target="i9FF9yoav58OheTaMKSd-17" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-30" value="Connection&lt;br&gt;lost" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-29" vertex="1" connectable="0">
                    <mxGeometry x="-0.1636" y="2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-31" value="Receive&lt;br&gt;confimation" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="690" y="349" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-32" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-35" target="i9FF9yoav58OheTaMKSd-7" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-33" style="edgeStyle=none;html=1;" parent="1" source="i9FF9yoav58OheTaMKSd-35" target="i9FF9yoav58OheTaMKSd-17" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-34" value="ERR_FNAME_TOO_BIG" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="i9FF9yoav58OheTaMKSd-33" vertex="1" connectable="0">
                    <mxGeometry x="-0.1716" y="-2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-35" value="Send init&lt;br&gt;packet" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="260" y="500" width="70" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="i9FF9yoav58OheTaMKSd-36" value="&lt;font style=&quot;font-size: 35px&quot;&gt;DNS sender&lt;br&gt;Finite State Machine&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="15" y="60" width="330" height="50" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>
